<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./index.css" />
    <script src="https://d3js.org/d3.v6.js"></script>
    <title>US GDP</title>
</head>
<body>
    <div id="container">
        <h3 id="title">United States GDP</h3>
    </div>
    <script>
        let dataset=[]
        d3.json("https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/GDP-data.json")
          .then(function(gdp) {
            const w = 1000;
            const h = 600;
            const PADDING = 50;
            
            const yearArr = gdp.data.map((x)=>x[0]);
            const gdpArr = gdp.data.map((x)=>x[1]);
            console.log(gdp.data);//debug
            console.log(yearArr); //debug
            console.log(gdpArr);  //debug

            const svg = d3.select("div")
                          .append("svg")
                          .attr("width", w)
                          .attr("height", h);

            svg.selectAll("rect")
               .data(gdpArr)
               .enter()
               .append("rect")
               .attr("x", (d, i) => (i * 3)+PADDING)
               .attr("y", (d, i) => h-d/60-PADDING)
               .attr("width", 15)
               .attr("height", (d, i) => d/60)
               .attr("fill", "navy")
               .attr("class", "bar")
               .on("mouseover", mouseover)
               .on("mouseout", mouseout);
           
            const xScale = d3.scaleTime()
                             .domain([new Date(d3.min(yearArr)), new Date(d3.max(yearArr))])
                             .range([PADDING,w-PADDING]);
                             
            const xAxis = d3.axisBottom(xScale);
            svg.append("g")
               .attr("id","x-axis")
               .attr("transform", "translate(-10,"+(h-PADDING)+")")
               .call(xAxis);
               
            const yScale = d3.scaleLinear()
                             .domain([d3.min(gdpArr), d3.max(gdpArr)])
                             .range([h+PADDING, PADDING])
                             
            const yAxis = d3.axisLeft(yScale);
            yAxis.ticks(10);
            svg.append("g")
               .attr("id","y-axis")
               .attr("transform", "translate("+PADDING+","+0+")")
               <!-- .attr("transform", "translate(60,-100)") -->
               .call(yAxis)
               
            let div = d3.select("#container")
                        .append("div")
                        .attr("class","tooltip")
                        .style("display","none")
                        .html("something");
                        
            function mouseover() {
                const current = d3.select(this);
                let leftOffset = parseInt(current.attr("x"))+PADDING;
                let topOffset = parseInt(current.attr("y"))-50;
                console.log("current position: ",current.attr('x'),current.attr('y')); //debug
                div.style("display","inline")
                   .style("left",leftOffset.toString()+"px")
                   .style("top",topOffset.toString()+"px");
            }
            
            function mouseout() {
                div.style("display","none");
            }
          });

        
    </script>
    <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
</body>
</html>
